<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì›”ë³„ ìê¸ˆí˜„í™© í…ìŠ¤íŠ¸ ë³´ê³ ì„œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nanum Gothic', 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .main-content {
            padding: 30px;
        }

        .auto-section {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #10b981;
            text-align: center;
        }

        .auto-section h3 {
            color: #065f46;
            margin-bottom: 15px;
        }

        .status {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 500;
            text-align: center;
        }

        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }

        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }

        .btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(79, 70, 229, 0.3);
        }

        .report-preview {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            font-family: 'Nanum Gothic', monospace;
            font-size: 14px;
            line-height: 1.8;
            white-space: pre-line;
            max-height: 600px;
            overflow-y: auto;
            color: #2d3748;
        }

        .copy-btn {
            background: #10b981;
            font-size: 0.9em;
            padding: 8px 16px;
        }

        .copy-btn:hover {
            box-shadow: 0 8px 15px rgba(16, 185, 129, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“„ ì›”ë³„ ìê¸ˆí˜„í™© í…ìŠ¤íŠ¸ ë³´ê³ ì„œ</h1>
            <p>í•œêµ­ì–´ í…ìŠ¤íŠ¸ ê¸°ë°˜ ì¬ë¬´ ë³´ê³ ì„œ ìƒì„±</p>
        </div>

        <div class="main-content">
            <div class="auto-section">
                <h3>ğŸ“Š í…ìŠ¤íŠ¸ ë³´ê³ ì„œ ìƒì„±</h3>
                <p>ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í•œêµ­ì–´ í…ìŠ¤íŠ¸ í˜•íƒœì˜ ì›”ë³„ ìê¸ˆí˜„í™© ë³´ê³ ì„œ</p>
                <button class="btn" onclick="generateTextReport()">ğŸ“„ í…ìŠ¤íŠ¸ ë³´ê³ ì„œ ìƒì„±</button>
                <button class="btn copy-btn" onclick="copyReport()" id="copyBtn" style="display:none;">ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬</button>
            </div>

            <div id="statusDiv"></div>
            <div id="reportDiv"></div>
        </div>
    </div>

    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ rowId ì¶”ì¶œ
        const urlParams = new URLSearchParams(window.location.search);
        const rowId = urlParams.get('rowId');

        window.onload = function() {
            if (rowId) {
                showStatus('ROW IDê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤: ' + rowId, 'info');
                setTimeout(() => {
                    generateTextReport();
                }, 2000);
            } else {
                showStatus('í…ŒìŠ¤íŠ¸ ëª¨ë“œì…ë‹ˆë‹¤. ë²„íŠ¼ì„ í´ë¦­í•´ì„œ í…ìŠ¤íŠ¸ ë³´ê³ ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”.', 'info');
            }
        };

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusDiv');
            statusDiv.innerHTML = '<div class="status ' + type + '">' + message + '</div>';
        }

        function generateTextReport() {
            showStatus('í…ìŠ¤íŠ¸ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” ì¤‘...', 'info');
            
            try {
                // í˜„ì¬ ë‚ ì§œ
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const date = String(today.getDate()).padStart(2, '0');
                const dateStr = `${year}ë…„ ${month}ì›” ${date}ì¼`;
                
                // ë³´ê³ ì„œ í…ìŠ¤íŠ¸ ìƒì„±
                const reportText = `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ${year}ë…„ ${month}ì›” ìê¸ˆí˜„í™© ë³´ê³ ì„œ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… ë³´ê³ ì„œ ìƒì„±ì¼: ${dateStr}
ğŸ“‹ ë³´ê³  ëŒ€ìƒ: ${year}ë…„ ${month}ì›”
ğŸ‘¤ ì‘ì„±ì: ìë™ìƒì„±ì‹œìŠ¤í…œ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            ğŸ“Š ì›”ê°„ ìš”ì•½
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’° ì´ë²ˆ ë‹¬ ì´ ìˆ˜ì…:        3,600,000ì›
ğŸ’¸ ì´ë²ˆ ë‹¬ ì´ ì§€ì¶œ:        2,850,000ì›
ğŸ“ˆ ì´ë²ˆ ë‹¬ ìˆ˜ì§€ì°¨ì•¡:          750,000ì›
ğŸ“Š ìˆ˜ì§€ìœ¨:                     79.2%

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            ğŸ’µ ìˆ˜ì… í˜„í™©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ê¸‰ì—¬ì†Œë“                   3,200,000ì›
2. íˆ¬ììˆ˜ìµ                     250,000ì›
3. ê¸°íƒ€ìˆ˜ì…                     150,000ì›
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ’° ì´ ìˆ˜ì…                 3,600,000ì›

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            ğŸ’¸ ì§€ì¶œ í˜„í™©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¸ ê³ ì •ì§€ì¶œ
   1. ëŒ€ì¶œìƒí™˜                   300,000ì›
   2. ë³´í—˜ë£Œ                     180,000ì›
   3. êµí†µë¹„                     120,000ì›
   4. í†µì‹ ë¹„                      75,000ì›
   5. ìƒí™œë¹„                     500,000ì›
   6. ë™í˜¸íšŒë¹„                    30,000ì›
   7. êµ¬ë…ë£Œ                      45,000ì›
   8. ì ê¸ˆ                       800,000ì›
   9. ê¸°íƒ€                        50,000ì›
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ì†Œê³„ (ê³ ì •ì§€ì¶œ)             2,100,000ì›

ğŸ”¸ ë³€ë™ì§€ì¶œ
   1. ì‹ë¹„/ì™¸ì‹                  300,000ì›
   2. ì‡¼í•‘/ì˜ë¥˜                  150,000ì›
   3. ì·¨ë¯¸/ì—¬ê°€                  120,000ì›
   4. ì˜ë£Œë¹„                      80,000ì›
   5. ê¸°íƒ€ ë³€ë™ë¹„ìš©              100,000ì›
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ì†Œê³„ (ë³€ë™ì§€ì¶œ)               750,000ì›

   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ’¸ ì´ ì§€ì¶œ                 2,850,000ì›

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            ğŸ¦ ìì‚° í˜„í™©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¸ ìœ ë™ìì‚°
   1. í˜„ê¸ˆ                     5,200,000ì›
   2. ì˜ˆì ê¸ˆ                  12,500,000ì›
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ’ ì´ ìì‚°                17,700,000ì›

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            ğŸ“ˆ ë¶„ì„ ë° ì½”ë©˜íŠ¸
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ìˆ˜ì… ëŒ€ë¹„ ì§€ì¶œ ë¹„ìœ¨: 79.2% (ì–‘í˜¸)
âœ… ì €ì¶•ë¥ : 20.8% (ëª©í‘œ ëŒ€ë¹„ ì–‘í˜¸)
âš ï¸  ë³€ë™ì§€ì¶œ ë¹„ì¤‘: 26.3% (ê´€ë¦¬ í•„ìš”)

ğŸ“ ì´ë²ˆ ë‹¬ íŠ¹ì´ì‚¬í•­:
   - íˆ¬ììˆ˜ìµì´ ì „ì›” ëŒ€ë¹„ ì¦ê°€í•¨
   - ì ê¸ˆë‚©ì…ì„ ê³„íšëŒ€ë¡œ ì´í–‰í•¨
   - ë³€ë™ì§€ì¶œ ê´€ë¦¬ ì§€ì† í•„ìš”

ğŸ“‹ ë‹¤ìŒ ë‹¬ ê³„íš:
   - ë³€ë™ì§€ì¶œ 10% ì ˆì•½ ëª©í‘œ
   - íˆ¬ì í¬íŠ¸í´ë¦¬ì˜¤ ì¬ê²€í† 
   - ë¹„ìƒìê¸ˆ ì¶©ë¶„ì„± ì ê²€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ë³´ê³ ì„œ ì¢…ë£Œ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€» ì´ ë³´ê³ ì„œëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
â€» ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë‹´ë‹¹ìì—ê²Œ ì—°ë½í•´ì£¼ì„¸ìš”.
`;

                // ë³´ê³ ì„œ í‘œì‹œ
                const reportDiv = document.getElementById('reportDiv');
                reportDiv.innerHTML = '<div class="report-preview">' + reportText + '</div>';
                
                // ë³µì‚¬ ë²„íŠ¼ í‘œì‹œ
                document.getElementById('copyBtn').style.display = 'inline-block';
                
                showStatus('í…ìŠ¤íŠ¸ ë³´ê³ ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                
                // ì „ì—­ ë³€ìˆ˜ì— ë³´ê³ ì„œ ì €ì¥ (ë³µì‚¬ìš©)
                window.generatedReport = reportText;
                
            } catch (error) {
                console.error('ë³´ê³ ì„œ ìƒì„± ì˜¤ë¥˜:', error);
                showStatus('ë³´ê³ ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }

        function copyReport() {
            if (window.generatedReport) {
                navigator.clipboard.writeText(window.generatedReport).then(function() {
                    showStatus('ë³´ê³ ì„œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                }, function(err) {
                    // í´ë¦½ë³´ë“œ API ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²•
                    const textArea = document.createElement('textarea');
                    textArea.value = window.generatedReport;
                    document.body.appendChild(textArea);
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        showStatus('ë³´ê³ ì„œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    } catch (err) {
                        showStatus('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                    document.body.removeChild(textArea);
                });
            }
        }
    </script>
</body>
</html>